<script>
// ========== Clean Loader for 10 More Bullets ==========

// Make sure the page layout is correct
window.addEventListener("DOMContentLoaded", () => {
  document.body.style.margin = "0";
  document.body.style.height = "100vh";
  document.body.style.overflow = "hidden";
});

// Optional: Google Analytics (safe version)
window.dataLayer = window.dataLayer || [];
function gtag() { dataLayer.push(arguments); }
gtag("js", new Date());
gtag("config", "G-H40DD7W802", { "send_page_view": false });
gtag("event", "page_view", { dimension1: location.href, dimension2: location.host });

// ========== Event Controls ==========

// Disable scroll keys (space, arrows)
window.onkeydown = (event) => {
  if (event.keyCode >= 32 && event.keyCode <= 40) event.preventDefault();
};

// Handle mouse/touch interactions
let isFirstClick = true;

function handleMouseDown(evt) {
  evt.preventDefault();
  evt.stopPropagation();
  evt.target.style.cursor = "default";
  window.focus();
}

function handleMouseUp(evt) {
  evt.preventDefault();
  evt.stopPropagation();
  evt.target.style.cursor = "";
}

function handleTouchStart(evt) {
  if (isFirstClick) {
    isFirstClick = false;
    // Uncomment if the game needs manual init:
    // if (window.initGwt) window.initGwt();
  }
}

const embed = document.getElementById("embed-html");
if (embed) {
  embed.addEventListener("mousedown", handleMouseDown);
  embed.addEventListener("mouseup", handleMouseUp);
  embed.addEventListener("touchstart", handleTouchStart);
}

// ========== Visibility handling ==========
document.addEventListener("visibilitychange", () => {
  if (document.hidden && typeof window.onTabHidden === "function") {
    window.onTabHidden();
  } else if (!document.hidden && typeof window.onTabVisible === "function") {
    window.onTabVisible();
  }
});

// ========== Optional Debug Logger ==========
(function() {
  const origOpen = XMLHttpRequest.prototype.open;
  XMLHttpRequest.prototype.open = function(...args) {
    console.log("XHR:", args[1]);
    origOpen.apply(this, args);
  };
})();
</script>
